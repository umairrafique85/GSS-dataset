swirl(0)
choose(5, 3) * (0.8^5)*(0.2^2)+ choose(5, 4) * (0.8^5)*(0.2^1) + choose(5, 5) * (0.8^5)*(0.2^0)
(choose(5, 3) * (0.8^5)*(0.2^2))+ (choose(5, 4) * (0.8^5)*(0.2^1)) + (choose(5, 5) * (0.8^5)*(0.2^0))
(choose(5,3) * (0.8^5)*(0.2^2))+ (choose(5,4) * (0.8^5)*(0.2^1)) + (choose(5,5) * (0.8^5)*(0.2^0))
(choose(5,3)*(0.8)^5*(0.2)^2)+ (choose(5,4) * (0.8)^5*(0.2)^1) + (choose(5,5) * (0.8)^5*(0.2)^0
)
(choose(5,3)*(0.8)^5*(0.2)^(5-3))+ (choose(5,4) * (0.8)^5*(0.2)^(5-4)) + (choose(5,5) * (0.8)^5*(0.2)^(5-5))
choose(5,3)*(0.8)^5*(0.2)^(5-3) + choose(5,4)*(0.8)^5*(0.2)^(5-4) + choose(5,5)*(0.8)^5*(0.2)^(5-5)
choose(5,3)*(.8)^5*(.2)^(5-3) + choose(5,4)*(.8)^5*(.2)^(5-4) + choose(5,5)*(.8)^5*(.2)^(5-5)
info()
(choose(5,3)*(.8)^5*(.2)^(5-3) + (choose(5,4)*(.8)^5*(.2)^(5-4)) + (choose(5,5)*(.8)^5*(.2)^(5-5))
(choose(5,3)*(.8)^5*(.2)^(5-3)) + (choose(5,4)*(.8)^5*(.2)^(5-4)) + (choose(5,5)*(.8)^5*(.2)^(5-5))
sum((choose(5,3)*(.8)^5*(.2)^(5-3)), (choose(5,4)*(.8)^5*(.2)^(5-4)), (choose(5,5)*(.8)^5*(.2)^(5-5)))
round(sum((choose(5,3)*(.8)^5*(.2)^(5-3)), (choose(5,4)*(.8)^5*(.2)^(5-4)), (choose(5,5)*(.8)^5*(.2)^(5-5))))
round(sum((choose(5,3)*(.8)^5*(.2)^(5-3)), (choose(5,4)*(.8)^5*(.2)^(5-4)), (choose(5,5)*(.8)^5*(.2)^(5-5))),2)
round(sum((choose(5,3)*(.8)^5*(.2)^(5-3)), (choose(5,4)*(.8)^5*(.2)^(5-4)), (choose(5,5)*(.8)^5*(.2)^(5-5))),3)
pbinom(2, 5, 0.8, lower.tail = F)
pbinom(2, 5, 0.8, lower.tail = F)
pbinom(2,size = 5, prob = .8, lower.tail = F)
pbinom(2,size = 5, prob = .8, lower.tail = FALSE)
qnorm(0.1)
0
qnorm(0.975, 3, 2)
1.96*2 + 3
pnorm(1200, 1020, 50, lower.tail = FALSE)
pnorm((1200-1020)/50)
pnorm((1200-1020)/50, lower.tail = F)
pnorm((1200-1020)/50, lower.tail = FALSE)
qnorm(0.75, 1020, 50)
.53
.53
ppois(3, 10)
ppois(3, 2.5*4)
pbinom(5, 1000, 0.1)
pbinom(5, 1000, .1)
pbinom(5,1000,.1)
pbinom(5,1000,.01)
ppois(5, 1000*0.01)
coinPlot
coinPlot(10)
coinPlot(10000)
q('no')
library(readr)
bat10 <- read_table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt')
View(bat10)
head(bat10)
bat10 <- read.table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = '\')
bat10 <- read.table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = '\\')
head(bat10)
bat10 <- read.table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = '\\\')
bat10 <- read.table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = '\\\')
bat10 <- read.table('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = "\\")
View(bat10)
head(bat10)
bat10 <- read.csv('/media/umair/F00E03AB0E0369C4/Studies/Stats/os3_data/mlbBat10.txt', sep = "\\")
head(bat10)
library(openintro)
data("mlbBat10")
View(mlbBat10)
mean(subset(mlbBat10, position=="OF")$OBP)
q('no')
library(c(tidyverse, openintro))
library(tidyverse)
library(openintro)
data("mlbBat10")
mlbBat10 %>% group_by(position) %>% summarise(OBP = mean(OBP))
bat10 <- mlbBat10 %>% head(327)
View(bat10)
bat10 %>% group_by(position) %>% summarise(OBP = mean(OBP))
with(bat10, boxplot(OBP ~ position))
bat10 %>% filter(position %in% c('OF', 'DH', 'C')) %>% boxplot(OBP~position)
batfiltered <- bat10 %>% filter(position %in% c('OF', 'DH', 'C'))
with(batfiltered, boxplot(OBP~position))
bat10 %>% group_by(position) %>% summarise(x = mean(OBP), s=sd(OBP), n=n())
pf(3, 323)
pf(1.984, 3, 323)
pf(1.984, 3, 323, lower.tail = F)
data("stats.scores")
View(stats.scores)
xA, xB, xC <- 75.1, 72, 78.9
xA <- 75.1
xB <- 72.0
xC <- 78.9
nA <- 58
nB <- 55
nC <- 51
xA-xB
x <- xA-xB
SE <- sqrt(((13.61^2)/nA)+((13.61^2)/nB))
qt(3.1, 161)
3.1/2.56
pt(1.21, 161)
pt(1.21, 161, lower.tail = F)*2
x <- xA-xC
SE <- sqrt(((13.61^2)/nA)+((13.61^2)/nC))
x/SE
t <- x/SE
pt(t, 161)*2
x <- xB-xC
SE <- sqrt(((13.61^2)/nB)+((13.61^2)/nC))
x/SE
pt(x/SE, 161)*2
library(openintro)
qt(0.05, 5)
q('no')
se <- 8/sqrt(20)
mu <- 60
qnorm(0.05, mu, se)
qt(0.05, 19)
mu+qt(0.05, 19)*se
t <- (4.6-5)/(2.2/sqrt(20))
t
pt(t, 19)
4.6+c(1, -1)*qt(0.025, 19)
4.6+c(1, -1)*qt(0.025, 19)*se
se
se <- 2.2/sqrt(20)
4.6+c(1, -1)*qt(0.025, 19)*se
10/1.96
(100/5.1)^2
se <- 4.9/sqrt(51)
x <- 1.1
z <- x/se
z
pnorm(1.6, 0, se)*2
pnorm(1.6, 0, se, lower.tail = F)*2
pt(1.6, 50)
pt(1.6, 50, lower.tail = F)
z
pnorm(1.1, 0, se, lower.tail = F)
pnorm(1.6, lower.tail = F)
1.1 + c(-1,1)*qt(0.05, 50)*se
q('no')
rm(list = ls())
library(statsr)
library(dplyr)
library(ggplot2)
data(nc)
View(nc)
with(nc, table(habit, lowbirthweight)()
with(nc, table(habit, lowbirthweight))
with(nc, prop.table(table(habit, lowbirthweight), 2))
with(nc, prop.table(table(habit, lowbirthweight), 1))
ggplot(nc, aes(x = weight)) + geom_histogram(facet_grid(habit))
ggplot(nc, aes(x = weight)) + geom_histogram() + facet_grid(habit)
ggplot(data = nc, aes(x = weight)) + geom_histogram() + facet_grid(habit)
ggplot(data = nc, aes(x = weight)) + geom_histogram() + facet_wrap(habit)
ggplot(data = nc, aes(x = weight)) + geom_histogram(facets = habit)
ggplot(data = nc, aes(x = weight)) + geom_histogram() + facet_grid('habit')
library(openintro)
data("yrbss")
names(yrbss)
?yrbss
summary(yrbss$text_while_driving_30d)
str(yrbss$text_while_driving_30d)
unique(yrbss$text_while_driving_30d)
mean(yrbss$height)
mean(yrbss$height, na.rm = )
mean(yrbss$height, na.rm = T)
data("yrbss.samp")
mean(yrbss.samp$height, na.rm = T)
hist(yrbss.samp$height)
hist(yrbss.samp$weight)
hist(yrbss.samp$physically_active_7d)
mean(yrbss.samp$weight, na.rm = T)
mean(yrbss.samp$physically_active_7d, na.rm = T)
nosim <- 1000
n <- 10
1/sqrt(10)
normmatrix <- matrix(rnorm(nosim * n), nrow = nosim)
summatrix <- apply(normmatrix, 1, mean)
summatrix2 <- rowMeans(normmatrix)
sd(summatrix2)
sd(summatrix)
n <- 30
sd(rowMeans(matrix(rnorm(nosim*n), nrow = nosim)))
1/sqrt(30)
n <- 50
sd(rowMeans(matrix(rnorm(nosim*n), nrow = nosim)))
1/sqrt(50)
library(statsr)
library(dplyr)
yrbss.samp1 <- sample_n(yrbss, 100)
rep_sample_n
data(ames)
ci <- ames %>% rep_sample_n(size = 60, reps = 50, replace = T)
View(ci)
summary(ci)
rep_sample_n
for (i in 1:50) {}
for (i in 1:50) {
for (i in 1:50) {
samp2 <- sample_n(yrbss, 50)
yrbss.samp1 <- rbind(yrbss.samp1, samp2)
head(yrbss.samp1)
yrbss.samp1 <- cbind(1, yrbss.samp1)
View(yrbss.samp1)
for (i in 2:50) {
samp2 <- sample_n(yrbss)
samp2 <- cbind(i, samp2)
yrbss.samp1 <- rbind(yrbss.samp1, samp2)
}
for (i in 2:50) {
samp2 <- sample_n(yrbss, 100)
samp2 <- cbind(i, samp2)
yrbss.samp1 <- rbind(yrbss.samp1, samp2)
}
View(samp2)
rep_sample_n
names(yrbss.samp1) <- c('sample', names(yrbss))
for (i in 2:50) {
samp2 <- sample_n(yrbss, 100)
samp2 <- cbind(i, samp2)
names(samp2) <- c('sample', names(yrbss))
yrbss.samp1 <- rbind(samp2, yrbss.samp1)
}
View(yrbss.samp1)
samplemeans <- yrbss.samp1 %>% group_by(sample) %>% summarise(avgarea= mean(area))
samplemeans <- yrbss.samp1 %>% group_by(sample) %>% summarise(avgarea= mean(physically_active_7d))
View(samplemeans)
samplemeans <- yrbss.samp1 %>% group_by(sample) %>% summarise(activedays= mean(physically_active_7d, na.rm = T))
hist(samplemeans$activedays)
samplemeans <- yrbss %>% rep_sample_n(size = 100, reps = 10000, replace = T) %>% summarise(avgactivedays = mean(physically_active_7d))
hist(samplemeans$activedays)
hist(samplemeans$avgactivedays)
samplemeans <- yrbss %>% rep_sample_n(size = 100, reps = 10000, replace = T) %>% summarise(avgactivedays = mean(physically_active_7d, na.rm = T))
hist(samplemeans$activedays)
hist(samplemeans$avgactivedays)
samplemeans <- yrbss %>% rep_sample_n(size = 100, reps = 100000, replace = T) %>% summarise(avgactivedays = mean(physically_active_7d, na.rm = T))
hist(samplemeans$avgactivedays)
mean(yrbss$physically_active_7d, na.rm = T)
q('no')
q('no')
data("iris")
str(iris)
plot(iris[c('petal.length', 'petal.width')])
iris.features <- iris[, -'Species']
iris.features <- iris[, -c('Species')]
iris.features <- iris[, 'Species']
iris.features <- iris[, '-Species']
iris.features <- iris[, -'Species']
iris.features <- iris['-Species']
iris.features <- iris[-'Species']
iris.features <- iris[-5]
str(iris.features)
kmeans(iris.features, 3)
kres <- kmeans(iris.features, 3)
kres$cluster
plot(iris[c('petal.length', 'petal.width')], col = kres$cluster)
iris[c('petal.length', 'petal.width')]
iris[,c('petal.length', 'petal.width')]
iris[, c('petal.length', 'petal.width')]
str(iris)
plot(iris[c('Petal.length', 'Petal.width')], col = kres$cluster)
plot(iris[c('Petal.Length', 'Petal.Width')], col = kres$cluster)
iris[-"Species"]
iris[-c("Species")]
iris[,-c("Species")]
q('no')
0.25/((0.04/1.96)^2)
qnorm(0.9, lower.tail = F)
qnorm(0.9)
qnorm(0.1)
p <- 0.017
(0.02/1.28)^2
x <- (0.02/1.28)^2
h <- function(x) {
h <- function(x, p) {
(p*(1-p))/x }
h(x, p)
h(x, 0.062)
h(x, 0.013)
qnorm(0.5)
qnorm(0.05)
qnorm(0.95)
x <- (0.02/qnorm(0.95))^2
h(x, 0.017)
h(x, 0.062)
h(x, 0.013)
0.017*114
(0.19*0.81)/((0.04/1.96)^2)
q('no')
library(UsingR)
data("father.son")
x <- father.son$sheight
n <- length(x)
hist(x)
ggplot(data = x, aes(x = x)) + geom_histogram()
ggplot(data = father.son, aes(x = x)) + geom_histogram()
ggplot(data = father.son, aes(x = sheight)) + geom_histogram()
ggplot(data = father.son, aes(x = sheight)) + geom_histogram(binwidth = 1)
q('no')
pbinom(6, size = 8, prob = 0.5, lower.tail = F)
qnorm(0.95, 29, 4.73)
pnorm(24.27, 29, 4.73)
pnorm(1160, 1020, 50, lower.tail = F)
qnorm(0.75, 1020, 50)
ppois(3, lambda = 2.5*4)
pbinom(2, 500, 0.01)
ppois(2, 500*0.01)
pbinom(8, 10, 0.5, lower.tail = F)
q('no')
(0.88*0.95)/(0.88*0.95+0.05*0.07)
qnorm(0.95, 100, 10)
pnorm(0.05, 100, 10/sqrt(50), lower.tail = F)
qnorm(0.05, 100, 10/sqrt(50), lower.tail = F)
qnorm(0.05, 100, 10/sqrt(50))
qnorm(0.95, 100, 10/sqrt(50))
pbinom(4, 6, 0.5, lower.tail = F)
pnorm(0.51, 0.5, (1/12)/sqrt(100))
pnorm(0.51, 0.5, (1/12)/sqrt(100), lower.tail = F)
pnorm(0.51, 0.5, sqrt((1/12)/100), lower.tail = F)
(1^2*1/6+2^2*1/6+3^2*1/6+4^2*1/6+5^2*1/6+6^2*1/6)-3/5^2
(1^2*1/6+2^2*1/6+3^2*1/6+4^2*1/6+5^2*1/6+6^2*1/6)-3.5^2
((1^2*1/6+2^2*1/6+3^2*1/6+4^2*1/6+5^2*1/6+6^2*1/6)-3.5^2)/10
ppois(20, 16.5*2)
ppois(21, 16.5*2)
pnorm(70, 80, 10)
qnorm(0.95, 1100, 75)
qnorm(0.95, 1100, 75/sqrt(100))
pbinom(3, 5, 0.5, lower.tail = F)
pnorm(16, 15, 10/sqrt(100))-pnorm(14, 15, 10/sqrt(100))
ppois(10, 5*3)
q('no')
library(keras)
imdb <- dataset_imdb(num_words = 10000)
imdb <- dataset_imdb(num_words = 10000)
q('no')
pdi <- 0.7-0.42
q('no')
r1sum <- sum(35, 19, 35, 29, 21)
r2sum <- sum(193, 132, 117, 119, 131)
r3sum <- sum(64, 51, 51, 32, 58)
tabtotal <- sum(292, 202, 203, 180, 210)
X2stat <- sum((((35-(r1sum*292)/tabtotal)^2)/(r1sum*292/tabtotal))+(((19-(r1sum*202)/tabtotal)^2)/(r1sum*202/tabtotal))+(((35-(r1sum*203)/tabtotal)^2)/(r1sum*202/tabtotal))+(((29-(r1sum*180)/tabtotal)^2)/(r1sum*180/tabtotal))+(((21-(r1sum*210/tabtotal))^2)/(r1sum*180/tabtotal))+(((193-(r2sum*292/tabtotal))^2)/(r2sum*292/tabtotal))+(((132-(r2sum*202/tabtotal))^2)/(r2sum*202/tabtotal))+(((117-(r2sum*203/tabtotal))^2)/(r2sum*203/tabtotal))+(((119-(r2sum*180/tabtotal))^2)/(r2sum*180/tabtotal))+(((131-(r2sum*210/tabtotal))^2)/(r2sum*210/tabtotal))+(((64-(r3sum*292/tabtotal))^2)/(r3sum*292/tabtotal))+(((51-(r3sum*202/tabtotal))^2)/(r3sum*202/tabtotal))+(((51-(r3sum*203/tabtotal))^2)/(r3sum*203/tabtotal))+(((32-(r3sum*180/tabtotal))^2)/(r3sum*180/tabtotal))+(((58-(r3sum*210/tabtotal))^2)/(r3sum*210/tabtotal)))
X2stat
pchisq(X2stat, 2*4, lower.tail = F)
q('no')
library(statsr)
library(openintro)
paul <- factor(c(rep('yes', 8), levels = c('yes', 'no')))
paul
inference(paul, est = 'proportion', type = 'ht', method = 'simulation', success = 'yes', null = 0.5, alternative = 'greater')
?inference
inference(paul, statistic  = 'proportion', type = 'ht', method = 'simulation', success = 'yes', null = 0.5, alternative = 'greater')
inference(paul, statistic = 'proportion', type = 'ht', method = 'simulation', success = 'yes', null = 0.5, alternative = 'greater')
inference(data = paul, statistic = 'proportion', type = 'ht', method = 'simulation', success = 'yes', null = 0.5, alternative = 'greater')
paul <- factor(c(rep('yes', 8), rep('no', 0), levels = c('yes', 'no')))
inference(data = paul, statistic = 'proportion', type = 'ht', method = 'simulation', success = 'yes', null = 0.5, alternative = 'greater')
back = factor(c(rep('correct', 11), rep('incorrect', 1)))
inference(back, statistic = 'proportion', type = 'ht', method = 'simulation', success = 'correct', null = 0.1, alternative = 'greater', nsim = 100)
(5/20)-(15/25)
70/560
pnorm(70/560, 0.15, sqrt(0.15*0.85/560))
pnorm(70/560, 0.15, sqrt(0.15*0.85/560))*2
0.15*560
pnorm(35/250, 0.1, sqrt(0.1*0.9/250), lower.tail = F)
35/250
p1 <- 71/144
p2 <- 224/389
phat <- (71+224)/(144+389)
p12 <- p1-p2
p12
se <- sqrt((phat*(1-phat)/144)+(phat*(1-phat)/389))
pnorm(p12, 0, se)*2
se
7*24/50
11/50
14/40-11/50
q('no')
library(statsr)
library(dplyr)
library(ggplot2)
q('no')
rm(list = ls())
setwd('/media/umair/F00E03AB0E0369C4/Studies/Stats/GSS')
load('gss.Rdata')
hist(gss$tvhours)
hist(gss$tvhours, ylab = 'hours spent daily watching tv', title = 'Histogram of hours spent watching tv')
hist(gss$tvhours, ylab = 'hours spent daily watching tv', main = 'Histogram of hours spent watching tv')
hist(gss$tvhours, ylab = 'hours spent daily watching tv', main = 'Histogram of hours spent watching tv')
hist(gss$tvhours, xlab = 'hours spent daily watching tv', main = 'Histogram of hours spent watching tv')
table(gss$homosex)
library(ggplot2)
library(tidyverse)
barplot(gss$homosex)
ggplot(data = gss, aes(x = homosex)) + geom_bar()
unique(gss$year)
views_comp_plt <- gss %>% select(year, homosex) %>% mutate(old = year<2000) %>% ggplot(aes(x = homosex))
views_comp_plt + geom_bar() + facet_grid(old ~)
views_comp_plt + geom_bar() + facet_grid(~ old)
views_comp_plt + geom_bar() + facet_wrap(~ old)
views_comp_plt + geom_bar() + facet_wrap(~ old, labeller = c('post-year 2000', 'pre-year 2000'))
views_comp_plt + geom_bar() + facet_wrap(~ old, labeller = label_value(c('post-year 2000', 'pre-year 2000'))
)
views_comp_plt <- gss %>% select(year, homosex) %>% mutate(old = year<2000)
views_comp_plt <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
views_comp_plt$era <- ifelse(views_comp_plt$era==FALSE, 'post-year 2000', 'pre-year 2000')
ggplot(data = views_comp_plt, aes(x = homosex)) + geom_bar() + facet_grid(~ era)
views_comp_plt$era <- ifelse(views_comp_plt$era==FALSE, 'post-year 2000', 'pre-year 2000')
prop.table(table(subset(gss, year<2000)$homosex), 1)
prop.table(table(subset(gss, year<2000)$homosex), 2)
table(subset(gss, year<2000)$homosex)
prop.table(table(subset(gss, year<2000)$homosex))
0.71+0.17+0.05+0.07+0.003
views_byYear <- gss %>% group_by(year, homosex) %>% summarise(number = n())
views_byYear
ggplot(views_byYear, aes(x = year, y = number, col = homosex)) + geom_line()
ggplot(views_byYear, aes(x = year, y = number, col = homosex)) + geom_line() + geom_smooth(method = 'lm')
views_byYear <- gss %>% group_by(year, teensex) %>% summarise(number = n())
ggplot(views_byYear, aes(x = year, y = number, col = homosex)) + geom_line() + geom_smooth(method = 'lm')
ggplot(views_byYear, aes(x = year, y = number, col = teensex)) + geom_line() + geom_smooth(method = 'lm')
views_byYear <- gss %>% group_by(year, premarsx) %>% summarise(number = n())
ggplot(views_byYear, aes(x = year, y = number, col = premarsx)) + geom_line() + geom_smooth(method = 'lm')
views_byYear <- gss %>% group_by(year, xmarsex) %>% summarise(number = n())
ggplot(views_byYear, aes(x = year, y = number, col = xmarsex)) + geom_line() + geom_smooth(method = 'lm')
added_era <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
added_era$era <- ifelse(added_era$era==FALSE, 'post-year 2000', 'pre-year 2000')
with(added_era, table(homosex, era))
with(added_era, prop.table(table(homosex, era), 2))
?summarise
views_byYear
with(added_era, prop.table(table(homosex, year), 2))
unique(gss$year)
propViews_byYear <- with(added_era, prop.table(table(homosex, year), 2))
typeof(propViews_byYear)
class(propViews_byYear)
propViews_byYear
View(propViews_byYear)
propViews_byYear <- as.data.frame(propViews_byYear)
View(propViews_byYear)
ggplot(propViews_byYear, aes(x = year, y = Freq, col = homosex)) + geom_line() + geom_smooth(method = 'lm')
ggplot(propViews_byYear, aes(x = year, y = Freq, col = homosex, group = year)) + geom_line() + geom_smooth(method = 'lm')
ggplot(propViews_byYear, aes(x = year, y = Freq, col = homosex, group = homosex)) + geom_line() + geom_smooth(method = 'lm')
?theme
?element_text
ggplot(data = added_era, aes(x = homosex)) + geom_bar() + facet_grid(~ era) + theme(axis.ticks.x = element_text(angle = 90))
ggplot(data = added_era, aes(x = homosex)) + geom_bar() + facet_grid(~ era) + theme(axis.text.x = element_text(angle = 90))
added_era <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
added_era$era <- ifelse(added_era$era==TRUE, 'pre-year 2000', 'post-year 2000')
ggplot(data = added_era, aes(x = homosex)) + geom_bar() + facet_grid(~ era) + theme(axis.text.x = element_text(angle = 90))
added_era <- gss %>% select(year, homosex) %>% mutate(era = year>=2000)
added_era$era <- ifelse(added_era$era==TRUE, 'post-year 2000', 'pre-year 2000')
ggplot(data = added_era, aes(x = homosex)) + geom_bar() + facet_grid(~ era) + theme(axis.text.x = element_text(angle = 90))
class(added_era$era)
added_era$eraf <- factor(added_era$era, levels = c('pre-year 2000', 'post-year 2000'))
View(added_era)
added_era <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
added_era$era <- ifelse(added_era$era==FALSE, 'post-year 2000', 'pre-year 2000')
added_era$era <- factor(added_era$era, levels = c('pre-year 2000', 'post-year 2000'))
ggplot(data = added_era, aes(x = homosex)) + geom_bar() + facet_grid(~ era) + theme(axis.text.x = element_text(angle = 90))
with(relevant_data, prop.table(table(homosex, era), 2))
relevant_data <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
with(relevant_data, prop.table(table(homosex, era), 2))
relevant_data$era <- ifelse(relevant_data$era==FALSE, 'post-year 2000', 'pre-year 2000')
relevant_data$era <- factor(relevant_data$era, levels = c('pre-year 2000', 'post-year 2000'))
with(relevant_data, prop.table(table(homosex, era), 2))
View(relevant_data)
relevant_data <- gss %>% select(year, homosex) %>% mutate(era = year<2000)
View(relevant_data)
relevant_data %>% group_by(homosex, era) %>% summarise(n())
relevant_data$era <- ifelse(relevant_data$era==FALSE, 'post-year 2000', 'pre-year 2000')
relevant_data %>% group_by(homosex, era) %>% summarise(n())
nrow(subset(relevant_data, era == 'pre-year 2000'))
nrow(subset(relevant_data, era == 'post-year 2000'))
proptable <- with(relevant_data, prop.table(table(homosex, era), 2))
proptable
View(proptable)
proptable <- as.data.frame(proptable)
proptable
p.diff <- relevant_props[1,2]-relevant_props[1,3]
relevant_props <- with(relevant_data, prop.table(table(homosex, era), 2))
relevant_props <- as.data.frame(relevant_props)
p.diff <- relevant_props[1,2]-relevant_props[1,3]
str(relevant_props)
p.diff <- relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3]-relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3]
p.diff
relevant_data %>% group_by(homosex, year) %>% summarise(n())
relevant_data %>% group_by(homosex, era) %>% summarise(n())
n_awpre2k <- nrow(subset(relevant_data, era == 'pre-year 2000' & homosex=='Always Wrong'))
n_awpre2k
n_pre2k <- nrow(subset(relevant_data, era == 'pre-year 2000'))
n_post2k <- nrow(subset(relevant_data, era == 'post-year 2000'))
n_awpre2k <- nrow(subset(relevant_data, era == 'pre-year 2000' & homosex=='Always Wrong'))
n_awpost2k <- nrow(subset(relevant_data, era == 'post-year 2000' & homosex=='Always Wrong'))
n_pre2k + n_post2k
p_hat_aw <- (n_awpre2k+n_awpost2k)/nrow(relevant_data)
SEaw <- sqrt(((p_hat_aw*(1-p_hat_aw))/n_pre2k)+((p_hat_aw*(1-p_hat_aw))/n_post2k))
point_est_aw <- relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3]-relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3]
pnorm(point_est_aw/SEaw, SEaw, lower.tail = F)
p_hat_aw
(0.71+0.53)/2
pnorm(relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3], elevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3], SEaw)
pnorm(relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3], relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3], SEaw)
pnorm(relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3], relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3], SEaw, lower.tail = F)
zscore <- point_est_aw/SEaw
pnorm(zscore, SEaw, lower.tail = F)
View(proptable)
prop_awpre2k <- subset(relevant_props, era == 'pre-year 2000' & homosex=='Always Wrong'))
prop_awpre2k <- subset(relevant_props, era == 'pre-year 2000' & homosex=='Always Wrong')
prop_awpost2k <- subset(relevant_data, era == 'post-year 2000' & homosex=='Always Wrong')
prop_awpost2k <- subset(relevant_data, era == 'post-year 2000' & homosex=='Always Wrong')$Freq
prop_awpost2k
prop_awpost2k <- subset(relevant_data, era == 'post-year 2000' & homosex=='Always Wrong')[,3]
View(prop_awpre2k)
prop_awpost2k <- subset(relevant_data, era == 'post-year 2000' & homosex=='Always Wrong')$Freq
prop_awpre2k <- relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='pre-year 2000',3]
prop_awpost2k <- relevant_props[relevant_props$homosex=='Always Wrong' & relevant_props$era=='post-year 2000',3]
6/(71+6+53)
71+6+53
(6/130)/59
130*59
